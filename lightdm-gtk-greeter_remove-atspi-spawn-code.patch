From 44b49a633e1367da4d09b984d099f05880abc925 Mon Sep 17 00:00:00 2001
From: leigh123linux <leigh123linux@googlemail.com>
Date: Fri, 13 Oct 2017 13:33:40 +0100
Subject: [PATCH] rebase patch

---
 configure.ac              | 15 ---------------
 src/lightdm-gtk-greeter.c |  8 ++------
 2 files changed, 2 insertions(+), 21 deletions(-)

diff --git a/configure.ac b/configure.ac
index 1e27de9..ebc33bd 100644
--- a/configure.ac
+++ b/configure.ac
@@ -111,21 +111,6 @@ AS_IF([test "x$with_libxklavier" = "xyes"],
 
 dnl ###########################################################################
 
-AC_ARG_ENABLE([at-spi-command],
-    AC_HELP_STRING([--enable-at-spi-command[=command]], [Try to start at-spi service]])
-    AC_HELP_STRING([--disable-at-spi-command], [Do not start at-spi service]),
-    [], [])
-
-AS_IF([test "x$enable_at_spi_command" != "xno"],
-[
-    if test "x$enable_at_spi_command" = "xyes" || test "x$enable_at_spi_command" = "x"; then
-        enable_at_spi_command="/usr/lib/at-spi2-core/at-spi-bus-launcher --launch-immediately"
-    fi
-    AC_DEFINE_UNQUOTED([AT_SPI_COMMAND], ["$enable_at_spi_command"], [Command to start at-spi service])
-])
-
-dnl ###########################################################################
-
 AC_ARG_ENABLE([indicator-services-command],
     AC_HELP_STRING([--enable-indicator-services-command[=command]], [Try to start indicators service]])
     AC_HELP_STRING([--disable-indicator-services-command], [Do not start indicators service]),
diff --git a/src/lightdm-gtk-greeter.c b/src/lightdm-gtk-greeter.c
index 1759c28..bd6841f 100644
--- a/src/lightdm-gtk-greeter.c
+++ b/src/lightdm-gtk-greeter.c
@@ -60,7 +60,7 @@ static LightDMGreeter *greeter;
 /* List of spawned processes */
 static GSList *pids_to_close = NULL;
 static GPid spawn_argv_pid (gchar **argv, GSpawnFlags flags, gint *pfd, GError **perror);
-#if defined(AT_SPI_COMMAND) || defined(INDICATOR_SERVICES_COMMAND)
+#if defined(INDICATOR_SERVICES_COMMAND)
 static GPid spawn_line_pid (const gchar *line, GSpawnFlags flags, GError **perror);
 #endif
 static void close_pid (GPid pid, gboolean remove);
@@ -391,7 +391,7 @@ spawn_argv_pid (gchar **argv, GSpawnFlags flags, gint *pfd, GError **perror)
     return pid;
 }
 
-#if defined(AT_SPI_COMMAND) || defined(INDICATOR_SERVICES_COMMAND)
+#if defined(INDICATOR_SERVICES_COMMAND)
 static GPid
 spawn_line_pid (const gchar *line, GSpawnFlags flags, GError **perror)
 {
@@ -2876,10 +2876,6 @@ main (int argc, char **argv)
         g_free (value);
     }
 
-    #ifdef AT_SPI_COMMAND
-    spawn_line_pid (AT_SPI_COMMAND, G_SPAWN_SEARCH_PATH, NULL);
-    #endif
-
     #ifdef INDICATOR_SERVICES_COMMAND
     spawn_line_pid (INDICATOR_SERVICES_COMMAND, G_SPAWN_SEARCH_PATH, NULL);
     #endif
-- 
2.13.6

